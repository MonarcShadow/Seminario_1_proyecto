# ğŸ“ Diagrama de Arquitectura - Sistema de RecolecciÃ³n de Madera

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    SISTEMA DE RECOLECCIÃ“N DE MADERA                          â•‘
â•‘                     (Aprendizaje por Refuerzo - Q-Learning)                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USUARIO                                                                     â”‚
â”‚                                                                              â”‚
â”‚   [1] python mundo2v2.py              â† Script principal                    â”‚
â”‚   [2] python utils_madera.py graficar â† VisualizaciÃ³n                       â”‚
â”‚   [3] python configurar.py            â† Setup                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MUNDO2V2.PY (Script Principal)                                              â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  obtener_mision_xml()                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Genera XML de Malmo                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Configura mundo (seed, spawn)                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ Define inventario inicial (hacha de madera)                      â”‚   â”‚
â”‚  â”‚  â””â”€ Establece lÃ­mites y condiciones de salida                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  entrenar(num_episodios=30)                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ Inicializa AgenteMaderaQLearning                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ Inicializa EntornoMadera                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ Bucle de episodios                                               â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€ ejecutar_episodio()                                          â”‚   â”‚
â”‚  â”‚  â””â”€ Guarda modelo cada N episodios                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ejecutar_episodio(max_pasos=800)                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ 1. obtener_observacion()                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ 2. agente.obtener_estado_discretizado()                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ 3. agente.elegir_accion()  [Îµ-greedy]                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ 4. entorno.ejecutar_accion()                                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ 5. Capturar recompensas de Malmo                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ 6. entorno.calcular_recompensa()                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ 7. agente.actualizar_q()                                         â”‚   â”‚
â”‚  â”‚  â””â”€ 8. Verificar objetivo (3 maderas)                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                â”‚
                 â–¼                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AGENTE_MADERA_RL.PY           â”‚  â”‚  ENTORNO_MADERA.PY                       â”‚
â”‚                                â”‚  â”‚                                          â”‚
â”‚  AgenteMaderaQLearning         â”‚  â”‚  EntornoMadera                           â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”                          â”‚
â”‚                                â”‚  â”‚                                          â”‚
â”‚  [Estado] (7 dimensiones)      â”‚  â”‚  [Observaciones Malmo]                   â”‚
â”‚  â”œâ”€ orientacion [0-3]          â”‚  â”‚  â”œâ”€ Grid 5Ã—5Ã—5 (125 bloques)             â”‚
â”‚  â”œâ”€ nivel_madera [0-2]         â”‚  â”‚  â”œâ”€ Raycast (tipo, distancia)            â”‚
â”‚  â”œâ”€ nivel_inventario [0-3]     â”‚  â”‚  â”œâ”€ Inventario (items, cantidades)       â”‚
â”‚  â”œâ”€ mirando_madera [0-1]       â”‚  â”‚  â”œâ”€ PosiciÃ³n (X, Y, Z)                   â”‚
â”‚  â”œâ”€ dist_categoria [0-2]       â”‚  â”‚  â””â”€ OrientaciÃ³n (Yaw, Pitch)             â”‚
â”‚  â”œâ”€ obstaculo_frente [0-1]     â”‚  â”‚                                          â”‚
â”‚  â””â”€ indicador_hojas [0-2]      â”‚  â”‚  [Sistema de Recompensas]                â”‚
â”‚                                â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  [Acciones] (7 comandos)       â”‚  â”‚  â”‚ Positivas:                         â”‚  â”‚
â”‚  0: move 1                     â”‚  â”‚  â”‚  +500  Completar (3 maderas)       â”‚  â”‚
â”‚  1: turn 1                     â”‚  â”‚  â”‚  +100  Conseguir 1 madera          â”‚  â”‚
â”‚  2: turn -1                    â”‚  â”‚  â”‚  +30   Picar madera                â”‚  â”‚
â”‚  3: jumpmove 1                 â”‚  â”‚  â”‚  +20   Mirar madera cerca          â”‚  â”‚
â”‚  4: attack 1   â­              â”‚  â”‚  â”‚  +10   Detectar madera/consistenciaâ”‚  â”‚
â”‚  5: strafe 1                   â”‚  â”‚  â”‚  +5    Detectar hojas              â”‚  â”‚
â”‚  6: strafe -1                  â”‚  â”‚  â”‚  +3    Moverse exitosamente        â”‚  â”‚
â”‚                                â”‚  â”‚  â”‚                                    â”‚  â”‚
â”‚  [Tabla Q]                     â”‚  â”‚  â”‚ Negativas:                         â”‚  â”‚
â”‚  Q: dict[estado, array[7]]     â”‚  â”‚  â”‚  -0.5  Costo acciÃ³n               â”‚  â”‚
â”‚  â”œâ”€ Valores Q por acciÃ³n       â”‚  â”‚  â”‚  -5    Picar aire                 â”‚  â”‚
â”‚  â”œâ”€ ActualizaciÃ³n:             â”‚  â”‚  â”‚  -10   ColisiÃ³n repetida          â”‚  â”‚
â”‚  â”‚   Q(s,a) â† Q(s,a) +         â”‚  â”‚  â”‚  -20   Loop de giros              â”‚  â”‚
â”‚  â”‚   Î±[r + Î³ max Q(s',a') -    â”‚  â”‚  â”‚  -25   Loop de ataques            â”‚  â”‚
â”‚  â”‚      Q(s,a)]                â”‚  â”‚  â”‚  -30   Atascado total             â”‚  â”‚
â”‚  â””â”€ PolÃ­tica Îµ-greedy          â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚      (exploraciÃ³n/explotaciÃ³n) â”‚  â”‚                                          â”‚
â”‚                                â”‚  â”‚  [DetecciÃ³n de Comportamiento]           â”‚
â”‚  [HiperparÃ¡metros]             â”‚  â”‚  â”œâ”€ Tracking de movimiento               â”‚
â”‚  â”œâ”€ alpha = 0.15               â”‚  â”‚  â”œâ”€ Historial de acciones (10 Ãºltimas)   â”‚
â”‚  â”œâ”€ gamma = 0.95               â”‚  â”‚  â”œâ”€ Contador de pasos sin movimiento     â”‚
â”‚  â”œâ”€ epsilon = 0.4 â†’ 0.05       â”‚  â”‚  â”œâ”€ DetecciÃ³n de loops                   â”‚
â”‚  â””â”€ epsilon_decay = 0.995      â”‚  â”‚  â””â”€ Sistema anti-stuck                   â”‚
â”‚                                â”‚  â”‚                                          â”‚
â”‚  [MÃ©todos]                     â”‚  â”‚  [MÃ©todos]                               â”‚
â”‚  â”œâ”€ obtener_estado_discretizadoâ”‚  â”‚  â”œâ”€ calcular_recompensa()                â”‚
â”‚  â”œâ”€ elegir_accion()            â”‚  â”‚  â”œâ”€ obtener_observacion()                â”‚
â”‚  â”œâ”€ actualizar_q()             â”‚  â”‚  â”œâ”€ ejecutar_accion()                    â”‚
â”‚  â”œâ”€ guardar_modelo()           â”‚  â”‚  â”œâ”€ verificar_objetivo_completado()      â”‚
â”‚  â””â”€ cargar_modelo()            â”‚  â”‚  â””â”€ reset()                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MINECRAFT + PROJECT MALMO                                                   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MalmoPython.AgentHost                                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ startMission()          â† Inicia episodio                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ getWorldState()          â† Obtiene observaciones                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ sendCommand()            â† Ejecuta acciones                        â”‚ â”‚
â”‚  â”‚  â””â”€ observations/rewards     â† JSON con datos del mundo                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  [Mundo Minecraft]                                                           â”‚
â”‚  â”œâ”€ Generado con seed fija (42)                                              â”‚
â”‚  â”œâ”€ Ãrboles naturales                                                        â”‚
â”‚  â”œâ”€ Agente con hacha de madera                                               â”‚
â”‚  â””â”€ Objetivo: Conseguir 3 bloques de madera                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ (despuÃ©s del entrenamiento)
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UTILS_MADERA.PY (VisualizaciÃ³n y AnÃ¡lisis)                                  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  graficar_aprendizaje()                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Carga modelo_agente_madera.pkl                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ Genera 4 grÃ¡ficos:                                               â”‚   â”‚
â”‚  â”‚  â”‚   1. Recompensas por episodio + media mÃ³vil                       â”‚   â”‚
â”‚  â”‚  â”‚   2. Madera recolectada (barras verde/rojo)                       â”‚   â”‚
â”‚  â”‚  â”‚   3. Pasos por episodio + eficiencia                              â”‚   â”‚
â”‚  â”‚  â”‚   4. Decaimiento de epsilon                                       â”‚   â”‚
â”‚  â”‚  â””â”€ Guarda: analisis_entrenamiento_madera.png                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  analizar_tabla_q()                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ Carga tabla Q                                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ Top N estados con mayor valor Q                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ EstadÃ­sticas (promedio, max, min, std)                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ DistribuciÃ³n de acciones preferidas                             â”‚   â”‚
â”‚  â”‚  â””â”€ AnÃ¡lisis de estados con madera visible                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  simular_episodio_greedy()                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ Ejecuta episodio sin exploraciÃ³n (epsilon=0)                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ EvalÃºa desempeÃ±o real del agente entrenado                      â”‚   â”‚
â”‚  â”‚  â””â”€ Retorna estadÃ­sticas detalladas                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ARCHIVOS GENERADOS                                                          â”‚
â”‚                                                                              â”‚
â”‚  â”œâ”€ modelo_agente_madera.pkl                                                 â”‚
â”‚  â”‚   â”œâ”€ Tabla Q: dict[estado] â†’ array[7]                                     â”‚
â”‚  â”‚   â”œâ”€ Episodios completados                                                â”‚
â”‚  â”‚   â”œâ”€ Epsilon actual                                                       â”‚
â”‚  â”‚   â””â”€ Historial: recompensas, pasos, madera                                â”‚
â”‚  â”‚                                                                            â”‚
â”‚  â””â”€ analisis_entrenamiento_madera.png                                        â”‚
â”‚      â””â”€ 4 grÃ¡ficos de visualizaciÃ³n                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FLUJO DE EJECUCIÃ“N (UN EPISODIO)                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  START
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Generar misiÃ³n   â”‚  mundo2v2.obtener_mision_xml(seed=42)
â”‚    (XML de Malmo)   â”‚  â†’ Mundo, inventario, lÃ­mites
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Iniciar misiÃ³n   â”‚  agent_host.startMission()
â”‚    en Minecraft     â”‚  â†’ Esperar has_mission_begun
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Reset entorno    â”‚  entorno.reset()
â”‚                     â”‚  â†’ madera_previa = 0
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       posicion_previa = (0,0,0)
       â”‚                      historial_acciones = []
       â”‚
       â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  BUCLE (hasta 800 pasos)  â”‚
   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                           â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.1 Obtener obs     â”‚  â”‚  world_state.observations
   â”‚  â”‚     de Malmo        â”‚  â”‚  â†’ JSON: grid, raycast, inventario
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.2 Discretizar     â”‚  â”‚  agente.obtener_estado_discretizado()
   â”‚  â”‚     estado          â”‚  â”‚  â†’ tupla (7 elementos)
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.3 Elegir acciÃ³n   â”‚  â”‚  agente.elegir_accion(estado)
   â”‚  â”‚     (Îµ-greedy)      â”‚  â”‚  â†’ Ã­ndice [0-6]
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.4 Ejecutar cmd    â”‚  â”‚  entorno.ejecutar_accion(comando)
   â”‚  â”‚     en Minecraft    â”‚  â”‚  â†’ agent_host.sendCommand()
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.5 Capturar        â”‚  â”‚  world_state.rewards
   â”‚  â”‚     recompensas     â”‚  â”‚  â†’ +100 si tocÃ³ madera (Malmo)
   â”‚  â”‚     de Malmo        â”‚  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.6 Calcular        â”‚  â”‚  entorno.calcular_recompensa()
   â”‚  â”‚     recompensa      â”‚  â”‚  â†’ Combina Malmo + seÃ±ales internas
   â”‚  â”‚     total           â”‚  â”‚     (+500 objetivo, +30 picar, etc.)
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.7 Actualizar      â”‚  â”‚  agente.actualizar_q()
   â”‚  â”‚     tabla Q         â”‚  â”‚  â†’ Q(s,a) â† Q(s,a) + Î±[r + Î³Â·max - Q]
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â–¼                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ 3.8 Verificar       â”‚  â”‚  entorno.verificar_objetivo_completado()
   â”‚  â”‚     inventario      â”‚  â”‚  â†’ Â¿madera â‰¥ 3?
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚                 â”‚
   â”‚         â”œâ”€ SÃ â”€â†’ BREAK   â”‚  Â¡Ã‰XITO!
   â”‚         â”‚                 â”‚
   â”‚         â””â”€ NO â”€â†’ CONTINÃšA â”‚  Siguiente paso
   â”‚                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ 4. Finalizar        â”‚  agente.finalizar_episodio()
       â”‚    episodio         â”‚  â†’ Guardar historial
       â”‚                     â”‚    Decaer epsilon
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ 5. Guardar modelo   â”‚  agente.guardar_modelo()
       â”‚    (cada 5 eps)     â”‚  â†’ modelo_agente_madera.pkl
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
          SIGUIENTE
          EPISODIO
          (o FIN)


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ESPACIO DE ESTADOS Y ACCIONES                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ESTADO (7 dimensiones)        ACCIONES (7 comandos)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  orientacion âˆˆ [0,1,2,3]       0: move 1        (avanzar)
       â†“                        1: turn 1        (girar â†’)
  4 orientaciones               2: turn -1       (girar â†)
                                3: jumpmove 1    (saltar)
  nivel_madera âˆˆ [0,1,2]        4: attack 1      (picar) â­
       â†“                        5: strafe 1      (lateral â†’)
  3 niveles                     6: strafe -1     (lateral â†)
  
  nivel_inventario âˆˆ [0,1,2,3]
       â†“
  4 niveles
  
  mirando_madera âˆˆ [0,1]
       â†“
  2 estados
  
  dist_categoria âˆˆ [0,1,2]
       â†“
  3 categorÃ­as
  
  obstaculo_frente âˆˆ [0,1]
       â†“
  2 estados
  
  indicador_hojas âˆˆ [0,1,2]
       â†“
  3 niveles
  
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  TOTAL: 4Ã—3Ã—4Ã—2Ã—3Ã—2Ã—3 = 864 estados posibles


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  SISTEMA DE RECOMPENSAS (11 TIPOS)                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   POSITIVAS (7)                  NEGATIVAS (4)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   +500  â”â”â”  Completar objetivo  -0.5  â–  Costo acciÃ³n
   +100  â”â”â”  +1 madera           -5    â–‚  Picar aire
   +30   â”â”   Picar madera        -10   â–ƒ  ColisiÃ³n repetida
   +20   â”â”   Mirar madera cerca  -20   â–„  Loop de giros
   +10   â”    Detectar madera     -25   â–…  Loop de ataques
   +5    â”    Detectar hojas      -30   â–†  Atascado total
   +3    â–    Moverse

```

---

**Leyenda**:
- â”â”â” : Recompensa/PenalizaciÃ³n muy alta
- â”â”  : Recompensa/PenalizaciÃ³n alta
- â”   : Recompensa/PenalizaciÃ³n media
- â–â–‚â–ƒ: PenalizaciÃ³n progresiva
- â­  : Nueva funcionalidad vs sistema agua

---

**Archivo**: DIAGRAMA_ARQUITECTURA.txt  
**Ãšltima actualizaciÃ³n**: 2 de noviembre de 2025
